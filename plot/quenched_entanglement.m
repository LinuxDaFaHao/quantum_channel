% Heisenberg model ground state, exp(-beta * sum(Sz_i))|GS>

ee_data = [0.693147 0.429556 0.737716 0.556628 0.775114 0.630104 0.805187 0.681136 0.829961 0.719854 0.85085 0.750773 0.868777 0.776287 0.884365 0.797815 0.898046 0.816262 0.910134 0.832243 0.920862 0.84619 0.930408 0.858422 0.938909 0.869174 0.946473 0.878631 0.953188 0.886934 0.959123 0.894195 0.964336 0.900504 0.968872 0.905932 0.97277 0.910536 0.97606 0.914364 0.978767 0.91745 0.980911 0.919823 0.982506 0.921503 0.983563 0.922506 0.98409 0.922839 0.98409 0.922506 0.983563 0.921503 0.982506 0.919823 0.98091 0.91745 0.978767 0.914364 0.97606 0.910536 0.97277 0.905932 0.968872 0.900504 0.964336 0.894195 0.959123 0.886934 0.953188 0.878631 0.946473 0.869174 0.938909 0.858422 0.930408 0.84619 0.920862 0.832243 0.910134 0.816262 0.898046 0.797815 0.884365 0.776287 0.868777 0.750773 0.85085 0.719854 0.829961 0.681137 0.805187 0.630104 0.775114 0.556628 0.737716 0.429556 0.693147;
    0.693109 0.429517 0.737648 0.556563 0.775021 0.630017 0.805072 0.681029 0.829826 0.719728 0.850697 0.750631 0.868609 0.77613 0.884181 0.797645 0.897849 0.816079 0.909925 0.832049 0.920642 0.845986 0.930178 0.858208 0.938669 0.868952 0.946225 0.878401 0.952933 0.886697 0.958861 0.893951 0.964068 0.900254 0.968599 0.905678 0.972492 0.910278 0.975778 0.914102 0.978482 0.917185 0.980623 0.919556 0.982217 0.921235 0.983273 0.922237 0.983799 0.92257 0.983799 0.922237 0.983273 0.921235 0.982216 0.919556 0.980623 0.917185 0.978482 0.914102 0.975778 0.910278 0.972492 0.905678 0.968599 0.900255 0.964068 0.893951 0.958861 0.886697 0.952933 0.878401 0.946225 0.868952 0.938669 0.858208 0.930178 0.845986 0.920642 0.832049 0.909925 0.816079 0.897849 0.797645 0.884182 0.776131 0.868609 0.750631 0.850697 0.719728 0.829826 0.681029 0.805072 0.630017 0.775021 0.556563 0.737648 0.429517 0.693109;
    0.689436 0.425791 0.731082 0.550293 0.766032 0.62158 0.793973 0.67068 0.816854 0.707665 0.836042 0.737017 0.852432 0.761106 0.866622 0.781334 0.879031 0.798594 0.889959 0.813489 0.899629 0.826446 0.908212 0.837776 0.915838 0.84771 0.92261 0.856425 0.928611 0.864062 0.933907 0.870728 0.938552 0.876511 0.942589 0.88148 0.946055 0.88569 0.948978 0.889185 0.951381 0.892002 0.953283 0.894166 0.954698 0.895698 0.955635 0.896612 0.956102 0.896915 0.956102 0.896612 0.955635 0.895698 0.954698 0.894166 0.953283 0.892002 0.951381 0.889185 0.948978 0.88569 0.946055 0.88148 0.94259 0.876511 0.938552 0.870728 0.933907 0.864062 0.928611 0.856425 0.92261 0.847709 0.915838 0.837776 0.908212 0.826447 0.899629 0.813489 0.889959 0.798594 0.879031 0.781334 0.866622 0.761106 0.852432 0.737017 0.836042 0.707665 0.816854 0.67068 0.793973 0.621581 0.766032 0.550293 0.731082 0.425791 0.689436;
    0.679027 0.415391 0.712757 0.532974 0.741199 0.598461 0.763552 0.642503 0.781527 0.674997 0.796352 0.700323 0.808829 0.720779 0.81949 0.737715 0.828705 0.751985 0.836738 0.764164 0.843782 0.774653 0.849985 0.783744 0.855458 0.791652 0.860288 0.798543 0.864545 0.804543 0.868284 0.809752 0.87155 0.81425 0.874379 0.818098 0.876799 0.821347 0.878835 0.824037 0.880506 0.826199 0.881825 0.827857 0.882805 0.829029 0.883454 0.829728 0.883778 0.82996 0.883778 0.829728 0.883454 0.829029 0.882805 0.827857 0.881825 0.826199 0.880506 0.824037 0.878835 0.821348 0.876799 0.818098 0.874379 0.81425 0.87155 0.809752 0.868284 0.804543 0.864545 0.798543 0.860288 0.791652 0.855458 0.783744 0.849985 0.774653 0.843782 0.764164 0.836738 0.751985 0.828706 0.737715 0.819491 0.72078 0.808829 0.700324 0.796353 0.674998 0.781527 0.642503 0.763552 0.598461 0.741199 0.532974 0.712757 0.415391 0.679027;
    0.507624 0.269975 0.457868 0.31678 0.433018 0.33367 0.417327 0.34132 0.406426 0.345234 0.398442 0.347404 0.392389 0.348678 0.387677 0.349458 0.383937 0.349952 0.380923 0.350276 0.378463 0.350495 0.37644 0.350651 0.374762 0.350764 0.373362 0.350847 0.372188 0.35091 0.371205 0.350961 0.370381 0.351 0.369692 0.351031 0.369121 0.351057 0.368653 0.351076 0.368279 0.351092 0.367989 0.351103 0.367776 0.351111 0.367637 0.351116 0.367568 0.351118 0.367568 0.351116 0.367637 0.351111 0.367776 0.351104 0.367989 0.351092 0.368279 0.351077 0.368654 0.351058 0.369122 0.351032 0.369693 0.351001 0.370381 0.350961 0.371205 0.35091 0.372189 0.350847 0.373361 0.350763 0.374763 0.350652 0.376441 0.350497 0.378464 0.350278 0.380924 0.349953 0.383938 0.349459 0.387678 0.348679 0.392391 0.347406 0.398444 0.345235 0.406426 0.34132 0.417327 0.33367 0.433018 0.31678 0.457868 0.269976 0.507623;
    0.623692 0.363677 0.621703 0.450793 0.623445 0.492661 0.624456 0.517338 0.624764 0.533501 0.624635 0.544809 0.624264 0.55309 0.623767 0.559359 0.623214 0.564228 0.622651 0.568088 0.622102 0.571197 0.621585 0.573737 0.621105 0.575831 0.620667 0.577568 0.62027 0.579017 0.619916 0.58023 0.619604 0.581242 0.619331 0.582083 0.619097 0.582777 0.618899 0.583338 0.618736 0.583782 0.618608 0.584118 0.618513 0.584353 0.618449 0.584492 0.618418 0.584538 0.618418 0.584492 0.618449 0.584353 0.618513 0.584118 0.618608 0.583782 0.618737 0.583339 0.618899 0.582777 0.619097 0.582084 0.619332 0.581242 0.619604 0.58023 0.619916 0.579017 0.62027 0.577568 0.620666 0.57583 0.621106 0.573737 0.621585 0.571198 0.622103 0.568088 0.622652 0.564229 0.623215 0.55936 0.623767 0.553091 0.624265 0.544811 0.624636 0.533502 0.624764 0.517339 0.624457 0.492661 0.623445 0.450793 0.621703 0.363677 0.623692;
    0.168408 0.0687697 0.115994 0.0753726 0.101243 0.0774564 0.0949423 0.078488 0.091601 0.0791207 0.089586 0.0795558 0.0882616 0.0798755 0.0873352 0.08012 0.0866595 0.0803117 0.0861481 0.0804659 0.0857511 0.0805917 0.0854396 0.0806971 0.0851887 0.080785 0.0849849 0.0808591 0.0848175 0.0809214 0.0846799 0.080975 0.0845652 0.081019 0.0844702 0.0810564 0.0843925 0.0810877 0.0843294 0.0811129 0.0842792 0.0811327 0.0842405 0.0811481 0.0842123 0.0811588 0.0841937 0.0811647 0.0841845 0.0811669 0.0841845 0.0811647 0.0841936 0.0811587 0.0842122 0.0811481 0.0842404 0.0811328 0.0842793 0.0811132 0.0843295 0.0810881 0.0843929 0.0810568 0.0844707 0.0810194 0.0845656 0.080975 0.0846799 0.0809216 0.084818 0.0808593 0.0849849 0.0807847 0.0851894 0.0806974 0.0854395 0.0805921 0.0857516 0.0804663 0.0861485 0.0803121 0.0866598 0.0801202 0.0873355 0.0798757 0.0882622 0.0795565 0.0895867 0.0791212 0.0916009 0.0784882 0.0949421 0.077456 0.101243 0.0753726 0.115994 0.0687698 0.168407;
    0.00296259 0.000974016 0.00175914 0.00108689 0.00151146 0.00112926 0.00141518 0.00115187 0.00136592 0.00116602 0.00133668 0.00117572 0.00131759 0.00118278 0.00130427 0.0011881 0.00129457 0.00119223 0.00128722 0.00119551 0.0012815 0.00119816 0.00127703 0.00120035 0.00127341 0.00120216 0.00127047 0.00120368 0.00126805 0.00120495 0.00126606 0.00120603 0.00126438 0.00120691 0.001263 0.00120766 0.00126187 0.00120828 0.00126095 0.00120878 0.00126022 0.00120917 0.00125965 0.00120948 0.00125924 0.00120969 0.00125897 0.00120981 0.00125884 0.00120985 0.00125884 0.0012098 0.00125897 0.00120969 0.00125924 0.00120948 0.00125965 0.00120917 0.00126022 0.00120879 0.00126095 0.00120829 0.00126187 0.00120766 0.00126301 0.00120691 0.00126439 0.00120603 0.00126606 0.00120495 0.00126806 0.00120369 0.00127047 0.00120216 0.00127342 0.00120036 0.00127702 0.00119817 0.00128151 0.00119552 0.00128722 0.00119224 0.00129457 0.00118811 0.00130427 0.00118278 0.0013176 0.00117573 0.00133669 0.00116603 0.00136592 0.00115187 0.00141518 0.00112926 0.00151145 0.00108689 0.00175913 0.000974017 0.00296258;
    8.82144e-07 2.66213e-07 5.05603e-07 3.00617e-07 4.30118e-07 3.13909e-07 4.01048e-07 3.21058e-07 3.86243e-07 3.25542e-07 3.77482e-07 3.28614e-07 3.71773e-07 3.30846e-07 3.67793e-07 3.3253e-07 3.64898e-07 3.33833e-07 3.62705e-07 3.34867e-07 3.61001e-07 3.35702e-07 3.59666e-07 3.36391e-07 3.58587e-07 3.3696e-07 3.5771e-07 3.37436e-07 3.56989e-07 3.37833e-07 3.56394e-07 3.38171e-07 3.55896e-07 3.38447e-07 3.55483e-07 3.38682e-07 3.55146e-07 3.38877e-07 3.54871e-07 3.39034e-07 3.54654e-07 3.39156e-07 3.54485e-07 3.39251e-07 3.54362e-07 3.39317e-07 3.54281e-07 3.39354e-07 3.54241e-07 3.39367e-07 3.54241e-07 3.39354e-07 3.5428e-07 3.39317e-07 3.54361e-07 3.39251e-07 3.54484e-07 3.39157e-07 3.54654e-07 3.39035e-07 3.54872e-07 3.38878e-07 3.55147e-07 3.38683e-07 3.55486e-07 3.38449e-07 3.55899e-07 3.38171e-07 3.56395e-07 3.37835e-07 3.56992e-07 3.37437e-07 3.57711e-07 3.36959e-07 3.58591e-07 3.36392e-07 3.59665e-07 3.35704e-07 3.61003e-07 3.34869e-07 3.62706e-07 3.33834e-07 3.64899e-07 3.3253e-07 3.67794e-07 3.30846e-07 3.71775e-07 3.28618e-07 3.77485e-07 3.25545e-07 3.86243e-07 3.2106e-07 4.01047e-07 3.13907e-07 4.30117e-07 3.00617e-07 5.056e-07 2.66213e-07 8.8214e-07];
beta_list = [0;0.001;0.01;0.02;0.05;0.1;0.3;0.9;2];
    
L = size(ee_data,2)+1;
l_list = 1:L-1;



% plot(l_list, ee_data,'-o');hold on;
% 
% 
% 
% 
% set(gca,'fontsize',24);
% set(gca,'linewidth',1.5);
% set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
% xlabel('$l$','Interpreter','latex');
% ylabel('entanglement entropy','Interpreter','latex');
% set(get(gca,'XLabel'),'FontSize',24);
% set(get(gca,'YLabel'),'FontSize',24);
% 
% figure;
start_site = 5;
plot(( sin(pi*(l_list/L))),ee_data,'-o');hold on;


fit_x=(sin(pi.*(l_list(start_site:2:end-start_site)/L)));
for i = 1:numel(beta_list)
    fit_y=ee_data(i, start_site:2:end-start_site);
%     p = fit((fit_x'),(fit_y'),'poly1');
%     plot(fit_x, p.p1*fit_x + p.p2,'-.');hold on;
%     c = p.p1 * 6;
%     fprintf('beta = %.4f, c =%.5f\n',beta_list(i),c);
    modelfun = @(b,x)( b(2)./(fit_x'.^b(3)) + b(1));
    mdl = fitnlm(fit_x,fit_y,modelfun,[0.1,0.1,0.1]);
   
    k = mdl.Coefficients.Estimate(3);
    b = mdl.Coefficients.Estimate;
    plot(fit_x, modelfun(b,fit_x),'-');
    fprintf("beta = %.4f, k = %.5f\n",beta_list(i),k);
end


l=legend('$\beta=0$', '$0.001$','$0.01$','$0.02$','$0.05$','$0.1$','$0.3$','$0.9$','$2$');
set(l,'Box','off');set(l,'Interpreter','latex');
set(l,'Fontsize',24);
set(l,'Location','SouthWest');

set(gca,'fontsize',24);
set(gca,'linewidth',1.5);
set(get(gca,'Children'),'linewidth',2); % Set line width 1.5 pounds
xlabel('$\sin(l/L)$','Interpreter','latex');
ylabel('entanglement entropy','Interpreter','latex');
set(get(gca,'XLabel'),'FontSize',24);
set(get(gca,'YLabel'),'FontSize',24);